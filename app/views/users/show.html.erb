<div class="container">
  <div class="margin-top"></div>
  <div class="margin-top"></div>
  <ul class="list-group">
    <li class="list-group-item">
      <div class="flex">
        <h3><%= @user.phone_number %></h3>
        <h3>
          <% if @user.first_name == "UNKNOWN" %>
            <span class="label label-info"><%= " #{@user.first_name}" %></span>
          <% else %>
            <%= " #{@user.first_name} #{@user.last_name}" %>
          <% end %>
        </h3>
      </div>
    </li>
    <li class="list-group-item">
      <%= link_to '< Tous les utilisateurs', users_path %>
    </li>
    <li class="list-group-item">
      <%= simple_form_for @message, url: messages_path do |f| %>
        <%= f.input :body, label: "Corps du message" %>
        <%= f.input :user, as: :hidden, input_html: { value: @user.phone_number } %>
        <%= f.button :submit%>
      <% end %>
    </li>
    <li class="list-group-item text-center" style="color:grey">
      <%= @user.messages.count.to_s + " messages (#{@user.messages.where(sender: true).count.to_s} envoyés, #{@user.messages.where(sender: false).count.to_s} reçus)" %>
    </li>
    <% @messages.each do |message| %>
      <li class="list-group-item">
        <ul class="list-group">
          <li class="list-group-item flex">
            <p>
              <% if message.sender %>
                <span class="label label-default">Utilisateur</span>
              <% else %>
                <span class="label label-info">ApiPapi</span>
              <% end %>
            </p>
            <p><%= message.created_at.to_s[0..18] %></p>
          </li>
          <li class="list-group-item">
            <strong><%= message.body %></strong>
          </li>
        </ul>
      </li>
    <% end %>
  </ul>
</div>
